---
title: Отладка
description: Техники и лучшие практики для отладки плагинов и обработки ошибок в процессе разработки вашего языкового модуля.
icon: lucide:bug
---

Отладка плагинов на Go в Plugify включает использование таких инструментов, как **Delve**, отладчик Go, для инспектирования и устранения неполадок в вашем коде. Это руководство предоставляет обзор того, как отлаживать плагины на Go, и направляет вас к внешним ресурсам для получения подробных инструкций.

## **Предварительные требования**

Перед отладкой ваших плагинов на Go убедитесь, что у вас есть следующее:

- **Go** (версия 1.20 или новее), установленный и настроенный.
- **Delve** (отладчик Go), установленный. Вы можете установить его, используя:
  ```bash
  go install github.com/go-delve/delve/cmd/dlv@latest
  ```
- **Основная библиотека Plugify** (собрана и доступна).
- **Языковой модуль Go** (`plugify-module-golang`), установленный и настроенный.
- Плагин на Go для отладки.

## **Отладка плагинов на Go**

Отладка плагинов на Go включает использование Delve для подключения к запущенному процессу Plugify и установки точек останова в вашем коде на Go. Ниже приведены общие шаги для отладки плагинов на Go:

::steps
### **Настройте вашу среду разработки**
- Убедитесь, что ваш плагин на Go собран в режиме **Debug**.
- Откройте ваш проект плагина на Go в вашей предпочитаемой IDE или текстовом редакторе (например, **VS Code**).

### **Запустите Plugify с включенной отладкой**
1. Запустите Plugify с загруженным вашим плагином на Go.
2. Убедитесь, что плагин на Go правильно инициализирован и запущен.

### **Подключите Delve к Plugify**
1. Используйте Delve для подключения к процессу Plugify:
   ```bash
   dlv attach <Plugify-PID>
   ```
   Замените `<Plugify-PID>` на идентификатор процесса Plugify.

2. В качестве альтернативы, вы можете запустить Plugify с Delve напрямую:
   ```bash
   dlv exec ./plugify -- <аргументы-plugify>
   ```

### **Установите точки останова**
- Откройте исходные файлы Go вашего плагина.
- Установите точки останова в вашем коде, добавив следующую строку там, где вы хотите приостановить выполнение:
  ```go
  runtime.Breakpoint()
  ```
- В качестве альтернативы, используйте интерфейс отладки вашей IDE для установки точек останова.

### **Отладьте ваш плагин**
- Активируйте функциональность в вашем плагине, которую вы хотите отладить.
- Отладчик приостановит выполнение на ваших точках останова, позволяя вам инспектировать переменные, пошагово выполнять код и анализировать стек вызовов.
::

## **Подробное руководство по отладке**

Для исчерпывающего пошагового руководства по отладке приложений на Go обратитесь к официальной документации по отладке Go:

:read-more{icon="lucide:link" to="https://github.com/golang/vscode-go/wiki/debugging" title="Отладка приложений на Go с помощью VS Code"}

## **Распространенные сценарии отладки**

### **1. Сбои плагина**
- Проверьте логи Plugify на наличие сообщений об ошибках.
- Используйте Delve для определения точной строки кода, вызывающей сбой.
- Инспектируйте переменные и память для диагностики проблемы.

### **2. Плагин не загружается**
- Убедитесь, что плагин скомпилирован правильно и размещен в правильном каталоге.
- Проверьте наличие отсутствующих зависимостей или несовместимых версий.
- Используйте Delve для пошагового выполнения кода инициализации плагина.

### **3. Неожиданное поведение**
- Установите точки останова в соответствующих функциях для отслеживания потока выполнения.
- Инспектируйте значения переменных для выявления расхождений.
- Используйте условные точки останова для отладки конкретных сценариев.

## **Продвинутые советы по отладке**

### **1. Используйте логирование**
- Добавляйте операторы логирования в код вашего плагина на Go для отслеживания потока выполнения и значений переменных.
- Используйте встроенную систему логирования Plugify для вывода сообщений в консоль или файлы логов.

### **2. Отладка горутин**
- Используйте команду `goroutines` в Delve для вывода списка всех активных горутин.
- Инспектируйте состояние каждой горутины для выявления потенциальных проблем.

### **3. Отладка состояний гонки**
- Используйте детектор состояний гонки Go для выявления состояний гонки:
  ```bash
  go run -race main.go
  ```
- Используйте Delve для отладки проблемных участков кода.

## **Устранение неполадок**

### **1. Отладчик не подключается**
- Убедитесь, что Plugify запущен и плагин загружен.
- Убедитесь, что Delve установлен и настроен правильно.

### **2. Точки останова не срабатывают**
- Убедитесь, что код плагина на Go соответствует скомпилированному бинарному файлу.
- Пересоберите плагин и перезапустите Plugify.

### **3. Сбои отладчика**
- Обновите Delve до последней версии.
- Убедитесь, что все зависимости совместимы с вашей средой разработки.

---

Для более продвинутых техник и инструментов отладки обратитесь к [документации Delve](https://github.com/go-delve/delve/tree/master/Documentation).