---
title: Как использовать
description: Практические примеры того, как читать, записывать и управлять файлами конфигурации из разных плагинов.
icon: lucide:book-open
---

**Плагин Configs** предоставляет простой API для управления файлами конфигурации в экосистеме Plugify. Основные функции включают `ReadConfig`, `WriteConfig` и `MergeConfig`. Это руководство проведет вас через использование этих функций с практическими примерами.

## **Начало работы**

Чтобы использовать плагин Configs, сначала убедитесь, что он загружен. После загрузки вы можете получить доступ к его функциям через API Plugify. Имя плагина — `configs`.

## **Чтение конфигурации**

Функция `ReadConfig` используется для чтения файла конфигурации из каталога другого плагина. Она автоматически определяет формат файла и возвращает данные в виде строки.

### **Пример: Чтение файла JSON**

Предположим, у вас есть плагин с именем `my_plugin`, который имеет файл конфигурации `config.json`, и пользователь создал свой собственный файл `user.json` в папке `res/configs`.

**Код C++**
```cpp
#include <iostream>
#include "configs.hpp" // Сгенерированный заголовочный файл

void ReadMyPluginConfig() {
    // Чтение файла конфигурации из 'my_plugin'
    const char* result = configs::ReadConfig("my_plugin", "config.json");
    if (result) {
        std::cout << result << std::endl;
        delete[] result; // Освободить память, выделенную плагином
    }
}
```

**Файл конфигурации (`my_plugin/config.json`)**
```json
{
  "setting1": "default_value",
  "setting2": 123
}
```

**Пользовательский файл конфигурации (`res/configs/my_plugin/user.json`)**
```json
{
  "setting1": "user_value"
}
```

**Ожидаемый вывод**
Функция `ReadConfig` автоматически объединит пользовательскую конфигурацию с конфигурацией по умолчанию.
```json
{
  "setting1": "user_value",
  "setting2": 123
}
```

### **Важное примечание**
Плагин Configs выделяет память для возвращаемой строки, которую необходимо освободить вручную с помощью `delete[] result;` после использования, чтобы избежать утечек памяти.

## **Запись конфигурации**

Функция `WriteConfig` используется для записи строки в файл конфигурации в папке `res/configs`.

### **Пример: Запись в файл конфигурации**
Этот пример показывает, как записать новую конфигурацию в файл `user.json` для `my_plugin`.

**Код C++**
```cpp
#include "configs.hpp"

void WriteMyPluginConfig() {
    const char* newData = R"({ "setting1": "new_user_value", "setting3": true })";
    // Запись новой конфигурации в 'user.json' для 'my_plugin'
    configs::WriteConfig("my_plugin", "user.json", newData);
}
```

**Итоговый `user.json`**
```json
{
  "setting1": "new_user_value",
  "setting3": true
}
```

## **Объединение конфигураций**

Функция `MergeConfig` объединяет два файла конфигурации. Это полезно, когда вам нужно объединить конфигурацию по умолчанию с пользовательской конфигурацией вручную.

### **Пример: Объединение конфигурации по умолчанию с пользовательской конфигурацией**
Этот пример показывает, как объединить `default.json` с `user.json`.

**Код C++**
```cpp
#include <iostream>
#include "configs.hpp"

void MergeMyConfigs() {
    const char* defaultConfig = R"({ "setting1": "default", "setting2": 10 })";
    const char* userConfig = R"({ "setting1": "user" })";
    
    const char* mergedResult = configs::MergeConfig(defaultConfig, userConfig, "json");
    if (mergedResult) {
        std::cout << mergedResult << std::endl;
        delete[] mergedResult;
    }
}
```

**Ожидаемый вывод**
```json
{
  "setting1": "user",
  "setting2": 10
}
```

## **Рекомендации**
- **Всегда освобождайте память**: Не забывайте освобождать память, возвращаемую `ReadConfig` и `MergeConfig`, с помощью `delete[]`.
- **Используйте правильные имена файлов**: Убедитесь, что вы используете правильные имена файлов конфигурации при чтении или записи.
- **Обрабатывайте ошибки**: Проверяйте наличие нулевых указателей при чтении конфигураций, чтобы корректно обрабатывать ошибки.

## **Заключение**

Плагин Configs предоставляет простой, но мощный способ управления файлами конфигурации в Plugify. Следуя примерам и рекомендациям, изложенным в этом руководстве, вы можете эффективно читать, записывать и объединять конфигурации, обеспечивая при этом сохранение пользовательских настроек.